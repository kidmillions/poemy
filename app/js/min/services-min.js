"use strict";Poemy.value("version","0.1"),Poemy.service("UtilSrvc",function(){return{isAString:function(t){return"string"==typeof t||"object"==typeof t&&t.constructor===String},helloWorld:function(t){var e="Hum, Hello you, but your name is too weird...";return this.isAString(t)&&(e="Hello, "+t),e}}}),Poemy.constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),Poemy.constant("USER_ROLES",{all:"all",admin:"admin",editor:"editor",guest:"guest"}),Poemy.factory("AuthService",function(t,e,o){var n={};return n.login=function(e,n){return t.post("/api/login",JSON.stringify(e)).then(function(t){var e=t.data;return console.log(e),o.destroy(),o.create("u",e._id,e.role),e})},n.isAuthenticated=function(){return!!o.userId},n.isAuthorized=function(t){angular.isArray(t)||(t=[t]);var e=!1;(o.userRole===t[0]||"all"==t[0])&&(e=!0);var n=e;return n},n}),Poemy.service("Session",function(){return this.create=function(t,e,o){this.id=t,this.userId=e,this.userRole=o},this.destroy=function(){this.id=null,this.userId=null,this.userRole=null},this}),Poemy.factory("AuthInterceptor",function(t,e,o){return{responseError:function(n){return t.$broadcast({401:o.notAuthenticated,403:o.notAuthorized,419:o.sessionTimeout,404:o.sessionTimeout}[n.status],n),e.reject(n)}}}),Poemy.factory("PoemRetrieval",function(t,e){return e.get("/api/poems").success(function(e,o,n,r){t.poems=e}).error(function(t,e,o,n){alert(t)}),t.poems});